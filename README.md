# hmm_window
This python code package is the software of the HMMDW method:
"Detection Windows from Hidden Markov Model for Discovering Varying Causal Relations Between Time Series"
about discovering the time-varying causal relationships between two time series.

## Python Dependencies
- numpy
- pandas
- scikit-learn (sklearn)
- scipy.stats

## Data
- simulated time series X and Y with one causal interval are generated by the code.
- real datasets Dropoff-tweet and Tweet-pickup, are from the Figure 4 of reference: 
Zhenhui Li, Guanjie Zheng, Amal Agarwal, Lingzhou Xue, Thomas Lauvaux. Discovery of Causal
Time Intervals. The Seventeenth SIAM International Conference on Data Mining, Houston, USA.,
2017:804-812


## The structure of this package:
data_causaltimeseries.py 	--- data generation, load a data set
inference_methods.py 	--- methods to discover causal relationships between two time series
causality_detect_functions.py 	--- the functions about causality test/detection
regression_withlag.py 	--- the regression model with time lag fit data
main_hmm_window.py	--- main function, HMM gives segmented regions, Causality test in segmented regions


## Citation
If this package is useful in your work, please consider the citing.
Kaijun WANG, et al. Detection Windows from Hidden Markov Model for Discovering Varying Causal Relations Between Time Series. 2024
https://github.com/wkjwang/hmm_window

